<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>á»¨ng dá»¥ng quáº£n lÃ½ tÃ i chÃ­nh vÃ  thá»i khÃ³a biá»ƒu</title>
  <link rel="stylesheet" href="css/style.css"/>
  <link rel="stylesheet" href="css/login.css"/>
  <link rel="stylesheet" href="css/calculator.css"/>
  <link rel="stylesheet" href="css/schedule.css"/>
</head>
<body>
  <div id="auth-section">
    <div class="auth-container">
      <h2 id="auth-title">ÄÄƒng nháº­p</h2>
      <form id="auth-form">
        <input type="email" id="username" placeholder="Email" required />
        <input type="password" id="password" placeholder="Máº­t kháº©u" required />
        <button type="submit" id="auth-btn">ÄÄƒng nháº­p</button>
      </form>
      <p id="toggle-auth">
        ChÆ°a cÃ³ tÃ i khoáº£n? <a href="#" id="toggle-link">ÄÄƒng kÃ½</a>
      </p>
    </div>
  </div>

  <div id="main-section" style="display: none;">
    <nav class="menu">
      <button onclick="showSection('calculator')">ğŸ’µ Calculator</button>
      <button onclick="showSection('schedule')">ğŸ“… Thá»i khÃ³a biá»ƒu</button>
      <button onclick="logout()">ğŸšª ÄÄƒng xuáº¥t</button>
    </nav>

    <div id="calculator-section" class="section">
  <h2>ğŸ’° Má»¥c tiÃªu</h2>
  <form id="calculator-form">
    <label for="target-amount">Sá»‘ tiá»n má»¥c tiÃªu:</label>
    <input type="text" id="target-amount" name="target-amount" placeholder="Nháº­p sá»‘ tiá»n (VND)" required>
    <label for="current-amount">Sá»‘ tiá»n hiá»‡n cÃ³:</label>
    <input type="text" id="current-amount" name="current-amount" placeholder="Nháº­p sá»‘ tiá»n (VND)" required>
    <label for="weekly-hours">Sá»‘ giá» lÃ m tuáº§n vá»«a qua:</label>
    <input type="number" id="weekly-hours" name="weekly-hours" placeholder="Nháº­p sá»‘ giá»" min="0">
    <button type="submit">ğŸ’¾ LÆ°u</button>
  </form>
  <div id="result-section">
    <div class="progress"></div>
    <button id="history-btn">ğŸ“œ Nháº­t kÃ½</button>
    <div id="history-section" style="display: none;"></div>
  </div>
</div>

    <div id="schedule-section" class="section" style="display: none;">
      <h2>ğŸ“… Thá»i khÃ³a biá»ƒu</h2>
      <button onclick="editSchedule()">Chá»‰nh sá»­a</button>
      <table id="schedule-table">
        <thead>
          <tr>
            <th></th>
            <th>Thá»© 2</th>
            <th>Thá»© 3</th>
            <th>Thá»© 4</th>
            <th>Thá»© 5</th>
            <th>Thá»© 6</th>
            <th>Thá»© 7</th>
            <th>CN</th>
          </tr>
        </thead>
        <tbody id="schedule-body"></tbody>
      </table>

      <div id="edit-schedule" style="display: none;">
        <h3>Chá»‰nh sá»­a thá»i khÃ³a biá»ƒu</h3>
        <form id="schedule-form">
          <label>Chá»n ngÃ y:</label>
          <select id="edit-day">
            <option value="0">Thá»© 2</option>
            <option value="1">Thá»© 3</option>
            <option value="2">Thá»© 4</option>
            <option value="3">Thá»© 5</option>
            <option value="4">Thá»© 6</option>
            <option value="5">Thá»© 7</option>
            <option value="6">CN</option>
          </select>
          <label>Chá»n ca:</label>
          <select id="edit-shift"></select>
          <label>Giá» ca:</label>
          <input type="text" id="shift-time" placeholder="VD: 6h-9h" />
          <label>Ghi chÃº:</label>
          <textarea id="shift-note" placeholder="ChÆ¡i vá»›i vá»£ hoáº·c Ä‘i há»c thÃªm, Ä‘i chÆ¡i"></textarea>
          <label>Icon hoáº¡t Ä‘á»™ng:</label>
          <select id="shift-icon">
            <option value="">âŒ KhÃ´ng chá»n</option>
            <option value="work">ğŸƒ Äi lÃ m</option>
            <option value="study">ğŸ“ Äi há»c</option>
            <option value="extra">ğŸ“š Há»c thÃªm</option>
            <option value="play">ğŸ® Äi chÆ¡i</option>
            <option value="Free">ğŸŒ·Í™Ö’ Free </option>
            <option value="other">ğŸ“Œ KhÃ¡c</option>
          </select>
          <button type="submit">ğŸ’¾ LÆ°u thay Ä‘á»•i</button>
        </form>
      </div>
    </div>
  </div>

  <!-- âœ… Firebase SDK (compat version v9) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBfl9q94MOE7XlxcPZBcobcDZBvJvjVgNk",
      authDomain: "myapp-49f38.firebaseapp.com",
      projectId: "myapp-49f38",
      storageBucket: "myapp-49f38.appspot.com",
      messagingSenderId: "974202894063",
      appId: "1:974202894063:web:a0bc790d0863fb8c95cd1a",
      measurementId: "G-MTN1WFF8RC"
    };
    firebase.initializeApp(firebaseConfig);
  </script>

  <script src="js/auth.js"></script>
  <script src="js/calculator.js"></script>
  <script src="js/schedule.js"></script>

  <!-- Script gáº¯n láº¡i sá»± kiá»‡n toggle sau khi cáº­p nháº­t DOM -->
  <script>
    function showSection(sectionId) {
      const sections = document.querySelectorAll('.section');
      sections.forEach(section => {
        section.style.display = 'none';
      });
      document.getElementById(sectionId + '-section').style.display = 'block';
      if (sectionId === 'schedule') {
        loadSchedule();
      }
    }

    function logout() {
      firebase.auth().signOut().then(() => {
        document.getElementById('main-section').style.display = 'none';
        document.getElementById('auth-section').style.display = 'block';
      }).catch((error) => {
        console.error('Logout error:', error);
      });
    }

    // Gáº¯n sá»± kiá»‡n chuyá»ƒn Ä‘á»•i Ä‘Äƒng nháº­p / Ä‘Äƒng kÃ½
    function attachToggleAuthEvent() {
      const toggleLink = document.getElementById('toggle-link');
      if (toggleLink) {
        toggleLink.addEventListener('click', (e) => {
          e.preventDefault();
          if (typeof toggleAuth === 'function') {
            toggleAuth();
          }
        });
      }
    }

    document.addEventListener('DOMContentLoaded', attachToggleAuthEvent);
  </script>
</body>
</html>
